<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ä¸Šä¼ éŸ³é¢‘</title>
</head>
<body>
    <h1>éŸ³é¢‘ç®¡ç†</h1>

    <!-- å¯¼èˆªé“¾æ¥ -->
    <div class="navigation">
        <a href="{{ url_for('digital_humans', user_id=user_id) }}">ğŸ¤– æ•°å­—äººç®¡ç†</a> |
        <a href="{{ url_for('documents', user_id=user_id) }}">ğŸ“„ æ–‡æ¡£ç®¡ç†</a> |
        <a href="{{ url_for('edit_profile', id=user_id) }}">ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯</a>
    </div>

    <!-- æ˜¾ç¤ºå½“å‰æ•°å­—äººä¿¡æ¯ -->
    {% if current_dh %}
    <div class="current-digital-human">
        <h3>å½“å‰æ•°å­—äººï¼š{{ current_dh.name }}</h3>
        <p>ç”µè¯ï¼š{{ current_dh.phone }}</p>
        <p>æè¿°ï¼š{{ current_dh.description }}</p>
    </div>
    {% endif %}

    <form action="{{ url_for('audio', user_id=user_id) }}" method="post" enctype="multipart/form-data">
        <div class="form-group">
            <label for="audio">é€‰æ‹©éŸ³é¢‘æ–‡ä»¶ï¼š</label>
            <input type="file" name="audio" id="audio" accept="audio/*">
        </div>
        
        <div class="form-group">
            <label for="digital_human_id">å…³è”æ•°å­—äººï¼š</label>
            <select id="digital_human_id" name="digital_human_id">
                <option value="">ä¸å…³è”</option>
                {% for dh in digital_humans %}
                    <option value="{{ dh.id }}" {% if current_dh and dh.id == current_dh.id %}selected{% endif %}>
                        {{ dh.name }}
                    </option>
                {% endfor %}
            </select>
        </div>
        
        <button type="submit">ä¸Šä¼ </button>
    </form>

    <h2>å·²ä¸Šä¼ çš„éŸ³é¢‘æ–‡ä»¶</h2>
    <ul>
        {% for file in files %}
            <li>
                <audio controls>
                    <source src="{{ url_for('static', filename=file.filepath) }}">
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘å…ƒç´ ã€‚
                </audio>
                
                <p>{{ file.filename }}</p>
                <p>ä¸Šä¼ æ—¶é—´: {{ file.upload_time }}</p>
                {% if file.digital_human %}
                    <p>å…³è”æ•°å­—äºº: {{ file.digital_human.name }}</p>
                {% endif %}

                <!-- åˆ é™¤æŒ‰é’® -->
                <form action="{{ url_for('delete', id=file.id, user_id=user_id) }}" method="post">
                    <button type="submit">åˆ é™¤</button>
                </form>
            </li>
        {% endfor %}
    </ul>

    <!-- æ˜¾ç¤º flash æ¶ˆæ¯ -->
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <ul>
                {% for message in messages %}
                    <li>{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}
</body>
</html>
